
#ifndef PARAMCOUNT
#define PARAMCOUNT 8 //  c,  ih,  iw,   kn,  kw,  kh,  p,  s
#endif

// ResNet18
#define layercount_resnet18 18
static int shapes_resnet18[layercount_resnet18][PARAMCOUNT] = {
    //  c,   ih,   iw,    kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   7,   7,   3,  2 },  

    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  

    {  64,   112,  112,  128,   1,   1,   0,  2 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  

    { 128,    56,   56,  256,   1,   1,   0,  2 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  

    { 256,    28,   28,  512,   1,   1,   0,  2 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  

    { 512,    14,   14, 1000,   1,   1,   0,  1 }   
};

// ResNet34
#define layercount_resnet34 34
static int shapes_resnet34[layercount_resnet34][PARAMCOUNT] = {
    //  c,  ih,  iw,   kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   7,   7,   3,  2 },  

    {   64,  112,  112,   64,   3,   3,   1,  1 },  
    {   64,  112,  112,   64,   3,   3,   1,  1 },  
    {   64,  112,  112,   64,   3,   3,   1,  1 },  
    {   64,  112,  112,   64,   3,   3,   1,  1 },  
    {   64,  112,  112,   64,   3,   3,   1,  1 },  
    {   64,  112,  112,   64,   3,   3,   1,  1 },  

    {  64,   112,  112,  128,   1,   1,   0,  2 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  

    { 128,    56,   56,  256,   1,   1,   0,  2 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  

    { 256,    28,   28,  512,   1,   1,   0,  2 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  

    {  512,    7,   7, 1000,   1,   1,  0,  1 }     
};

// VGG16
#define layercount_vgg16 16
static int shapes_vgg16[layercount_vgg16][PARAMCOUNT] = {
    //  c,   ih,   iw,    kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   3,   3,   1,  1 },  
    {  64,   224,  224,   64,   3,   3,   1,  1 },  

    {  64,   112,  112,  128,   3,   3,   1,  1 },  
    { 128,   112,  112,  128,   3,   3,   1,  2 },  
    
    { 128,    56,   56,  256,   3,   3,   1,  1 },  
    { 256,    56,   56,  256,   3,   3,   1,  1 },  
    { 256,    56,   56,  256,   3,   3,   1,  2 },  
    
    { 256,    28,   28,  512,   3,   3,   1,  1 },  
    { 512,    28,   28,  512,   3,   3,   1,  1 },  
    { 512,    28,   28,  512,   3,   3,   1,  2 },  
    
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  2 },  
    
    { 512,     7,    7, 4096,   1,   1,   0,  1 },  
    {4096,     1,    1, 4096,   1,   1,   0,  1 },  
    {4096,     1,    1, 1000,   1,   1,   0,  1 }   
};

// DarkNet19
#define layercount_darknet19 19
static int shapes_darknet19[layercount_darknet19][PARAMCOUNT] = {
    //  c,   ih,   iw,    kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   3,   3,   1,  2 },  
    
    {  64,   112,  112,   64,   3,   3,   1,  2 },  
    
    {  64,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,   64,   1,   1,   0,  1 },  
    {  64,    56,   56,  128,   3,   3,   1,  2 },  

    { 128,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28,  128,   1,   1,   0,  1 },  
    { 128,    28,   28,  256,   3,   3,   1,  2 },  

    { 256,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  256,   1,   1,   0,  1 },  
    { 256,    14,   14,  512,   3,   3,   1,  1 },  

    { 512,    14,   14,  256,   1,   1,   0,  1 },  
    { 256,    14,   14,  512,   3,   3,   1,  2 },  
    
    { 512,     7,    7, 1024,   3,   3,   1,  1 },  
    {1024,     7,    7,  512,   1,   1,   0,  1 },  
    { 512,     7,    7, 1024,   3,   3,   1,  1 },  
    {1024,     7,    7,  512,   1,   1,   0,  1 },  
    { 512,     7,    7, 1024,   3,   3,   1,  1 },  
    {1024,     7,    7, 1000,   1,   1,   0,  1 }   
};

// VGG19
#define layercount_vgg19 19
static int shapes_vgg19[layercount_vgg19][PARAMCOUNT] = {
    //  c,   ih,   iw,    kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   3,   3,   1,  1 },  
    {  64,   224,  224,   64,   3,   3,   1,  1 },  

    {  64,   112,  112,  128,   3,   3,   1,  1 },  
    { 128,   112,  112,  128,   3,   3,   1,  2 },  
    
    { 128,    56,   56,  256,   3,   3,   1,  1 },  
    { 256,    56,   56,  256,   3,   3,   1,  1 },  
    { 256,    56,   56,  256,   3,   3,   1,  1 },  
    { 256,    56,   56,  256,   3,   3,   1,  2 },  
    
    { 256,    28,   28,  512,   3,   3,   1,  1 },  
    { 512,    28,   28,  512,   3,   3,   1,  1 },  
    { 512,    28,   28,  512,   3,   3,   1,  1 },  
    { 512,    28,   28,  512,   3,   3,   1,  2 },  
    
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  2 },  
    
    { 512,     7,    7, 4096,   1,   1,   0,  1 },  
    {4096,     1,    1, 4096,   1,   1,   0,  1 },  
    {4096,     1,    1, 1000,   1,   1,   0,  1 }   
};

// DarkNet53
#define layercount_darknet53 53
static int shapes_darknet53[layercount_darknet53][PARAMCOUNT] = {
    //  c,   ih,   iw,    kn,  kw,  kh,  p,  s
    {   3,   416,  416,   64,   3,   3,   1,  2 },  
    {  64,   208,  208,   64,   3,   3,   1,  1 },  

    {  64,   208,  208,   64,   3,   3,   1,  1 },  
    {  64,   208,  208,   64,   1,   1,   0,  1 },  
    {  64,   208,  208,  128,   3,   3,   1,  2 },  

    { 128,   104,  104,   64,   1,   1,   0,  1 },  
    {  64,   104,  104,  128,   3,   3,   1,  1 },  
    { 128,   104,  104,   64,   1,   1,   0,  1 },  
    {  64,   104,  104,  128,   3,   3,   1,  1 },  
    { 128,   104,  104,  256,   3,   3,   1,  2 },  

    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  
    { 256,    52,   52,  128,   1,   1,   0,  1 },  
    { 128,    52,   52,  256,   3,   3,   1,  1 },  

    { 256,    52,   52,  512,   3,   3,   1,  2 },  
    
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  
    { 512,    26,   26,  256,   1,   1,   0,  1 },  
    { 256,    26,   26,  512,   3,   3,   1,  1 },  

    { 512,    26,   26, 1024,   3,   3,   1,  2 },  

    {1024,    13,   13,  512,   1,   1,   0,  1 },  
    { 512,    13,   13, 1024,   3,   3,   1,  1 },  
    {1024,    13,   13,  512,   1,   1,   0,  1 },  
    { 512,    13,   13, 1024,   3,   3,   1,  1 },  
    {1024,    13,   13,  512,   1,   1,   0,  1 },  
    { 512,    13,   13, 1024,   3,   3,   1,  1 },  
    {1024,    13,   13,  512,   1,   1,   0,  1 },  
    { 512,    13,   13, 1024,   3,   3,   1,  1 },  
    
    {1024,    13,   13, 1000,   1,   1,   0,  1 }   
};


// ResNet152
#define layercount_resnet152 152
static int shapes_resnet152[layercount_resnet152][PARAMCOUNT] = {
    //  c,  ih,  iw,   kn,  kw,  kh,  p,  s
    {   3,   224,  224,   64,   7,   7,   3,  2 },  

    // Conv2_x (3 blocks)
    {  64,   112,  112,   64,   1,   1,   0,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,  256,   1,   1,   0,  1 },  
    { 256,   112,  112,   64,   1,   1,   0,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,  256,   1,   1,   0,  1 },  
    { 256,   112,  112,   64,   1,   1,   0,  1 },  
    {  64,   112,  112,   64,   3,   3,   1,  1 },  
    {  64,   112,  112,  256,   1,   1,   0,  1 },  

    // Conv3_x (8 blocks)
    { 256,   112,  112,  128,   1,   1,   0,  2 },   
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  
    { 512,    56,   56,  128,   1,   1,   0,  1 },  
    { 128,    56,   56,  128,   3,   3,   1,  1 },  
    { 128,    56,   56,  512,   1,   1,   0,  1 },  

    // Conv4_x (36 blocks)
    { 512,    56,   56,  256,   1,   1,   0,  2 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  
    {1024,    28,   28,  256,   1,   1,   0,  1 },  
    { 256,    28,   28,  256,   3,   3,   1,  1 },  
    { 256,    28,   28, 1024,   1,   1,   0,  1 },  

    // Conv5_x (3 blocks)
    {1024,    28,   28,  512,   1,   1,   0,  2 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14, 2048,   1,   1,   0,  1 },  
    {2048,    14,   14,  512,   1,   1,   0,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14, 2048,   1,   1,   0,  1 },  
    {2048,    14,   14,  512,   1,   1,   0,  1 },  
    { 512,    14,   14,  512,   3,   3,   1,  1 },  
    { 512,    14,   14, 2048,   1,   1,   0,  1 },  

    // Fully Connected Layer
    {2048,    14,   14, 1000,   1,   1,   0,  1 } 
};




#define SHAPECOUNT_E2E 7
static int shapecount_e2e = SHAPECOUNT_E2E;
static int layercounts_e2e[SHAPECOUNT_E2E] = { layercount_resnet18, layercount_resnet34, layercount_vgg16, layercount_vgg19, layercount_darknet19, layercount_darknet53, layercount_resnet152 };
static int (*shapes_e2e[SHAPECOUNT_E2E])[PARAMCOUNT] = { shapes_resnet18, shapes_resnet34, shapes_vgg16, shapes_vgg19, shapes_darknet19, shapes_darknet53, shapes_resnet152  };
